{% extends "base.html" %}

{% block title %}{{ law.title }} - Dose de Lei Diária{% endblock %}

{% block head_extra %}
<style>
    /* Styles moved to base.html or adapted with dark: variants */
</style>
{% endblock %}

{% block content %}
{# Adjusted flex container for better mobile layout #}
<div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 space-y-2 sm:space-y-0">
    {# Applied responsive text size and dark mode color #}
    <h1 class="text-xl md:text-2xl font-bold text-blue-700 dark:text-blue-400">{{ law.title }}</h1>
    {# Applied responsive text size, dark mode color, and whitespace-nowrap #}
    <a href="{{ url_for("student.dashboard") }}" class="text-sm md:text-base text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 whitespace-nowrap self-end sm:self-center">
        <i class="fas fa-arrow-left mr-1 md:mr-2"></i> Voltar ao Painel
    </a>
</div>

{# Banners adapted for dark mode in base.html #}
{% if is_completed %}
<div class="completed-banner" role="alert">
    <i class="fas fa-check-circle mr-2"></i> Você já concluiu esta legislação!
</div>
{% elif last_read_article %}
<div class="last-read-info" role="alert">
    <i class="fas fa-bookmark mr-2"></i> Você parou no artigo: <strong>{{ last_read_article }}</strong>
</div>
{% endif %}

{# Container adapted for dark mode in base.html #}
<div class="law-content-container">
    {% if law.description %}
        {# Adapted text color for dark mode #}
        <p class="text-gray-600 dark:text-gray-400 italic mb-6">{{ law.description }}</p>
    {% endif %}
    
    {# Content should inherit dark mode text color from container #}
    {{ law.content | safe }}
</div>

{% if not is_completed %}
<!-- Save Last Read Article Form -->
{# Form container adapted for dark mode in base.html #}
<div class="save-article-form">
    {# Form elements adapted for dark mode in base.html #}
    <form action="{{ url_for("student.save_last_read", law_id=law.id) }}" method="POST" class="flex items-center space-x-3">
        <label for="last_article" class="text-sm font-medium">Parou no artigo nº:</label>
        <input type="text" id="last_article" name="last_article" 
               placeholder="Ex: 15" value="{{ last_read_article or '' }}"
               class="shadow-sm appearance-none border rounded-md py-1 px-2 leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent w-24">
        {# Button adapted for dark mode #}
        <button type="submit" class="bg-indigo-500 hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-500 text-white font-medium py-1 px-3 rounded-md transition duration-300 text-sm">
            <i class="fas fa-save mr-1"></i> Salvar Posição
        </button>
    </form>
</div>

<!-- Mark as Complete Button -->
<div class="mt-8 text-center">
    <form action="{{ url_for("student.mark_complete", law_id=law.id) }}" method="POST">
        {# Button adapted for dark mode #}
        <button type="submit" class="bg-green-500 hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-500 text-white font-bold py-3 px-6 rounded-lg transition duration-300 text-lg shadow-md">
            <i class="fas fa-check mr-2"></i> Marcar como Concluído
        </button>
    </form>
</div>
{% endif %}

{% endblock %}

{% block scripts %}
{# Removed protection scripts as they might interfere with usability and are generally bypassable #}
{# If protection is strictly needed, consider server-side or more robust solutions #}
{% endblock %}
